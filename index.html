<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AXON IMPACT GLOBAL</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { 
            --primary: #2ecc71; 
            --bg-dark: rgba(13, 17, 23, 0.7); 
            --panel: rgba(22, 27, 34, 0.88); 
            --text: #e6edf3; 
            --music: #8a2be2; 
            --video: #1f6feb;
        }
        
        body, html { 
            height: 100%; margin: 0; color: var(--text); 
            font-family: 'Segoe UI', sans-serif;
            background: url('https://i.postimg.cc/pXMzbPsj/20260216-171012-0000.png') no-repeat center center fixed;
            background-size: cover;
            display: flex; justify-content: center; align-items: center; overflow: hidden;
        }

        .overlay-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-dark); z-index: 1;
        }

        .container { position: relative; z-index: 2; display: flex; flex-direction: column; align-items: center; width: 100%; }

        .app-logo {
            width: 80%; max-width: 300px; height: auto;
            filter: drop-shadow(0 0 15px rgba(46, 204, 113, 0.5));
            margin-bottom: -30px; z-index: 3;
        }

        .panel { 
            background: var(--panel);
            padding: 45px 25px 30px 25px; border-radius: 30px; width: 85%; max-width: 380px; 
            text-align: center; border: 1px solid rgba(46, 204, 113, 0.4);
            box-shadow: 0 15px 35px rgba(0,0,0,0.8);
            backdrop-filter: blur(4px);
        }

        .btn { display: block; width: 100%; padding: 16px; margin: 12px 0; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; color: white; transition: 0.3s; font-size: 15px; text-transform: uppercase; }
        .btn-green { background: var(--primary); }
        .btn-music { background: var(--music); }
        
        input { width: 100%; background: rgba(13, 17, 23, 0.6); color: white; border: 1px solid #30363d; border-radius: 10px; padding: 12px; margin: 10px 0; box-sizing: border-box; }
        
        .song-list { max-height: 200px; overflow-y: auto; margin-top: 10px; border-radius: 10px; background: rgba(0,0,0,0.4); }
        .song-item { padding: 14px; border-bottom: 1px solid #333; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-size: 14px; }

        #player { width: 100%; border-radius: 15px; height: 220px; background: #000; margin-top: 15px; border: 1px solid var(--primary); }

        .screen { display: none; width: 100%; flex-direction: column; align-items: center; }
        #screen1 { display: flex; }

        #customModal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #1c2128; padding: 30px; border-radius: 25px; border: 2px solid var(--primary); z-index: 10000; width: 80%; text-align: center; }
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9999; }
    </style>
</head>
<body>

    <div class="overlay-bg"></div>

    <div id="modalOverlay" class="modal-overlay"></div>
    <div id="customModal">
        <h2 id="mTitle">ðŸ¦´</h2>
        <p id="mMsg"></p>
        <button class="btn btn-green" onclick="closeModal()">CONTINUAR</button>
    </div>

    <div class="container">
        <div id="screen1" class="screen">
            <img src="https://i.postimg.cc/pXMzbPsj/20260216-171012-0000.png" alt="Logo AXON" class="app-logo">
            <div class="panel">
                <h1 style="color: var(--primary); margin: 0; font-size: 24px;">AXON IMPACT GLOBAL</h1>
                <p style="font-size: 15px; color: #e6edf3; line-height: 1.5; margin: 20px 0;">
                    <b>Ayudando a personas necesitadas y animales de la calle con tu ayuda y el poder de Blockchain.</b>
                </p>
                <button onclick="nav('screen2')" class="btn btn-green">ENTRAR A MISIONES</button>
            </div>
        </div>

        <div id="screen2" class="screen">
            <div class="panel">
                <h3 style="margin-top:0;">MISIONES DISPONIBLES ðŸ¦´</h3>

                <div style="margin-bottom: 20px; border-top: 1px solid #333; padding-top: 15px;">
                    <h4 style="color: var(--music); margin: 0 0 10px 0;">ðŸŽµ MÃšSICA SOLIDARIA</h4>
                    
                    <input type="text" id="searchSong" placeholder="Buscar canciÃ³n..." onkeyup="filterSongs()">
                    
                    <div class="song-list" id="songList">
                        <div class="song-item" onclick="verContenido('jNQXAC9IVRw', 'ReggaetÃ³n Mix 2026', 15)">
                            <span>ðŸŽ§ ReggaetÃ³n Mix</span> <span style="color:var(--primary)">+15ðŸ¦´</span>
                        </div>
                        <div class="song-item" onclick="verContenido('5qap5aO4i9A', 'Rock Alternativo', 15)">
                            <span>ðŸŽ§ Rock Mix</span> <span style="color:var(--primary)">+15ðŸ¦´</span>
                        </div>
                    </div>
                </div>

                <p style="font-size: 18px; margin-top: 20px; font-weight: bold;">MIS MONEDAS: <span id="coinCount" style="color:var(--primary)">0</span></p>
            </div>
        </div>

        <div id="screen3" class="screen">
            <div class="panel">
                <h4 id="activeTitle" style="color: var(--primary); margin: 0;">Cargando...</h4>
                <div id="player"></div>
                <button id="btnVerify" class="btn btn-green" style="display:none; margin-top:15px;">âœ… RECLAMAR PUNTOS</button>
                <button onclick="nav('screen2')" class="btn" style="background:#333; margin-top: 10px;">SALIR</button>
            </div>
        </div>
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        let player, isPlaying = false, lastTime = 0, coins = 0, currentPoints = 0;

        function nav(id) {
            document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
            document.getElementById(id).style.display = 'flex';
        }

        function filterSongs() {
            let input = document.getElementById('searchSong').value.toLowerCase();
            let items = document.querySelectorAll('.song-item');
            items.forEach(item => {
                item.style.display = item.innerText.toLowerCase().includes(input) ? "flex" : "none";
            });
        }

        function verContenido(id, titulo, pts) {
            currentPoints = pts;
            lastTime = 0;
            document.getElementById('activeTitle').innerText = titulo;
            nav('screen3');
            if (player && player.loadVideoById) player.loadVideoById(id);
        }

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                videoId: '',
                playerVars: { 'modestbranding': 1, 'rel': 0, 'playsinline': 1, 'controls': 0 },
                events: {
                    'onStateChange': (e) => {
                        if (e.data == YT.PlayerState.PLAYING) { isPlaying = true; startSecurity(); }
                        else isPlaying = false;
                        if (e.data == YT.PlayerState.ENDED) document.getElementById('btnVerify').style.display = 'block';
                    }
                }
            });
        }

        function startSecurity() {
            const check = setInterval(() => {
                if (player && isPlaying) {
                    let curr = player.getCurrentTime();
                    if (curr > lastTime + 2.1) player.seekTo(lastTime);
                    else lastTime = curr;
                } else clearInterval(check);
            }, 1000);
        }

        document.getElementById('btnVerify').onclick = () => {
            coins += currentPoints;
            document.getElementById('coinCount').innerText = coins;
            showModal("Â¡RECOMPENSA!", `Has ganado ${currentPoints} monedas. Â¡Buen trabajo!`);
            document.getElementById('btnVerify').style.display = 'none';
        };

        function showModal(t, m) {
            document.getElementById('mTitle').innerText = t;
            document.getElementById('mMsg').innerText = m;
            document.getElementById('customModal').style.display = 'block';
            document.getElementById('modalOverlay').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('customModal').style.display = 'none';
            document.getElementById('modalOverlay').style.display = 'none';
            nav('screen2');
        }
    </script>
</body>
</html>

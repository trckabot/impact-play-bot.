<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AXON IMPACT GLOBAL - MATCH 3</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root { 
            --primary: #2ecc71; --bg-dark: rgba(13, 17, 23, 0.9); 
            --panel: rgba(22, 27, 34, 0.98); --text: #e6edf3; 
            --gold: #fbbd08; --video: #2185d0;
        }

        body, html { height: 100%; margin: 0; color: var(--text); font-family: 'Segoe UI', sans-serif; background: url('https://i.postimg.cc/pXMzbPsj/20260216-171012-0000.png') no-repeat center center fixed; background-size: cover; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .overlay-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-dark); z-index: 1; }
        .container { position: relative; z-index: 2; display: flex; flex-direction: column; align-items: center; width: 100%; }
        
        /* ESTADISTICAS ORIGINALES */
        .country-stats { position: fixed; top: 10px; right: 10px; background: rgba(0,0,0,0.8); padding: 8px; border-radius: 12px; font-size: 10px; border: 1px solid var(--primary); z-index: 10; }

        .panel { background: var(--panel); padding: 15px; border-radius: 30px; width: 90%; max-width: 380px; text-align: center; border: 1px solid rgba(46, 204, 113, 0.3); box-shadow: 0 15px 35px rgba(0,0,0,0.8); backdrop-filter: blur(10px); }

        /* TABLERO ESTILO CANDY CRUSH */
        .game-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding: 0 10px; }
        .grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; width: 330px; height: 330px; margin: 0 auto; background: rgba(0,0,0,0.4); padding: 8px; border-radius: 15px; border: 2px solid var(--primary); position: relative; }
        
        .cell { width: 42px; height: 42px; display: flex; align-items: center; justify-content: center; font-size: 22px; cursor: pointer; border-radius: 10px; background: rgba(255,255,255,0.05); transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; }
        .cell:hover { background: rgba(255,255,255,0.15); }
        .selected { transform: scale(1.15); box-shadow: 0 0 15px var(--gold); background: rgba(251, 189, 8, 0.3) !important; z-index: 10; }
        
        /* EXPLOSIONES */
        @keyframes pop { 0% { transform: scale(1); } 50% { transform: scale(1.4); opacity: 0.7; } 100% { transform: scale(0); opacity: 0; } }
        .exploding { animation: pop 0.4s forwards; }

        .btn { display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 18px; font-weight: bold; cursor: pointer; color: white; font-size: 13px; text-transform: uppercase; }
        .btn-video { background: var(--video); }
        .btn-back { background: #1b1c1d; font-size: 10px; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="overlay-bg"></div>

    <div class="country-stats">
        <b style="color: var(--primary);">AXON NETWORK</b>
        <div style="display:flex; justify-content:space-between; gap:10px;"><span>LIVE USERS</span> <span>1,240</span></div>
    </div>

    <div class="container">
        
        <div id="screenStart" class="screen" style="display: flex; flex-direction: column; align-items: center;">
            <img src="https://i.postimg.cc/pXMzbPsj/20260216-171012-0000.png" style="width: 200px; border-radius: 40px; margin-bottom: 15px; box-shadow: 0 0 30px var(--primary);">
            <div class="panel">
                <h2 style="color: var(--primary); margin: 0;">CRYPTO MATCH 3</h2>
                <p style="font-size: 13px; opacity: 0.8;">Explota las criptos para financiar la ayuda social.</p>
                <button onclick="startGame()" class="btn" style="background: var(--primary);">JUGAR NIVEL 1</button>
            </div>
        </div>

        <div id="screenGame" class="screen" style="display: none; flex-direction: column; align-items: center;">
            <div class="panel">
                <div class="game-header">
                    <div><small>PUNTOS</small><br><b id="score" style="color: var(--gold); font-size: 20px;">0</b></div>
                    <div><small>MOVIMIENTOS</small><br><b id="moves" style="color: var(--primary); font-size: 20px;">20</b></div>
                </div>
                
                <div id="grid" class="grid"></div>
                
                <div style="margin-top: 15px; font-size: 12px;">
                    Objetivo: Consigue <b>2,000</b> puntos para cobrar ü¶¥
                </div>
                <button onclick="location.reload()" class="btn btn-back">CANCELAR MISION</button>
            </div>
        </div>
    </div>

    <script>
        const width = 7;
        const candyIcons = ['‚Çø', 'Œû', '√ê', 'üëõ', '‚ù§Ô∏è'];
        let squares = [];
        let score = 0;
        let moves = 20;
        let firstSquare, secondSquare;

        function startGame() {
            document.getElementById('screenStart').style.display = 'none';
            document.getElementById('screenGame').style.display = 'flex';
            createBoard();
        }

        function createBoard() {
            const grid = document.getElementById('grid');
            for (let i = 0; i < width * width; i++) {
                const square = document.createElement('div');
                square.className = 'cell';
                square.setAttribute('id', i);
                let randomIcon = candyIcons[Math.floor(Math.random() * candyIcons.length)];
                square.innerHTML = randomIcon;
                grid.appendChild(square);
                squares.push(square);

                square.onclick = () => selectSquare(square);
            }
            // Limpiar matches iniciales sin dar puntos
            while(checkMatches(false)) { fillBoard(); }
        }

        function selectSquare(square) {
            if (!firstSquare) {
                firstSquare = square;
                square.classList.add('selected');
            } else {
                secondSquare = square;
                let id1 = parseInt(firstSquare.id);
                let id2 = parseInt(secondSquare.id);
                
                // Comprobar si son adyacentes
                const validMoves = [id1 - 1, id1 + 1, id1 - width, id1 + width];
                if (validMoves.includes(id2)) {
                    swapSquares(id1, id2);
                } else {
                    firstSquare.classList.remove('selected');
                    firstSquare = null;
                }
            }
        }

        function swapSquares(id1, id2) {
            let temp = squares[id1].innerHTML;
            squares[id1].innerHTML = squares[id2].innerHTML;
            squares[id2].innerHTML = temp;
            
            if (checkMatches(true)) {
                moves--;
                document.getElementById('moves').innerText = moves;
                firstSquare.classList.remove('selected');
                firstSquare = null;
                if(moves <= 0) endGame();
            } else {
                // Revertir si no hay match
                setTimeout(() => {
                    squares[id2].innerHTML = squares[id1].innerHTML;
                    squares[id1].innerHTML = temp;
                    firstSquare.classList.remove('selected');
                    firstSquare = null;
                }, 300);
            }
        }

        function checkMatches(givePoints) {
            let hasMatch = false;
            // Filas
            for (let i = 0; i < 49; i++) {
                let rowOfThree = [i, i + 1, i + 2];
                if (i % width < width - 2) {
                    let icon = squares[i].innerHTML;
                    if (icon !== '' && rowOfThree.every(idx => squares[idx].innerHTML === icon)) {
                        if(givePoints) score += 100;
                        rowOfThree.forEach(idx => squares[idx].classList.add('exploding'));
                        hasMatch = true;
                    }
                }
            }
            // Columnas
            for (let i = 0; i < 35; i++) {
                let colOfThree = [i, i + width, i + width * 2];
                let icon = squares[i].innerHTML;
                if (icon !== '' && colOfThree.every(idx => squares[idx].innerHTML === icon)) {
                    if(givePoints) score += 100;
                    colOfThree.forEach(idx => squares[idx].classList.add('exploding'));
                    hasMatch = true;
                }
            }

            if (hasMatch) {
                document.getElementById('score').innerText = score;
                setTimeout(removeAndFill, 400);
                return true;
            }
            return false;
        }

        function removeAndFill() {
            squares.forEach(sq => {
                if (sq.classList.contains('exploding')) {
                    sq.innerHTML = '';
                    sq.classList.remove('exploding');
                }
            });
            fillBoard();
        }

        function fillBoard() {
            squares.forEach(sq => {
                if (sq.innerHTML === '') {
                    sq.innerHTML = candyIcons[Math.floor(Math.random() * candyIcons.length)];
                }
            });
            setTimeout(() => checkMatches(true), 300);
        }

        function endGame() {
            if (score >= 2000) {
                Swal.fire('¬°Nivel Completado!', `Ganaste ${score} puntos y 500 ü¶¥ de recompensa.`, 'success')
                .then(() => location.reload());
            } else {
                Swal.fire('Sin movimientos', 'No alcanzaste el objetivo. ¬°Mira un video para reintentar!', 'error')
                .then(() => location.reload());
            }
        }
    </script>
</body>
</html>
